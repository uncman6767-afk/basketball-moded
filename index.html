<!DOCTYPE html>
<html>
<head>
<title>Basketball Bros MAX</title>
<style>
body { margin:0; background:#0b0b0b; overflow:hidden; }
canvas { display:block; margin:auto; background:linear-gradient(#1e90ff,#0b3d91); }
</style>
</head>
<body>
<canvas id="c" width="1000" height="520"></canvas>
<script>
const ctx=c.getContext("2d");
let keys={},paused=false;
onkeydown=e=>keys[e.key]=true;
onkeyup=e=>keys[e.key]=false;

const G=0.9,FLOOR=430;
let shake=0,particles=[];
let time=60,over=false;

function beep(f=400,d=0.05){
 let a=new AudioContext(),o=a.createOscillator();
 o.connect(a.destination);o.frequency.value=f;o.start();
 setTimeout(()=>{o.stop();a.close()},d*1000);
}

const player={
 x:200,y:350,w:40,h:70,vx:0,vy:0,
 speed:9,jump:20,stam:100,score:0
};

const ai={
 x:650,y:350,w:40,h:70,vx:0,vy:0,score:0
};

const ball={x:0,y:0,vx:0,vy:0,held:true,owner:"p"};

const hoop={x:900,y:220,w:50};

function resetBall(o="p"){
 ball.held=true;ball.owner=o;
 ball.vx=ball.vy=0;
}

function shoot(p){
 ball.held=false;
 ball.vx=p===player?13:-13;
 ball.vy=-14;
 beep(600);
}

function dunk(p){
 ball.held=false;
 ball.vx=0; ball.vy=8;
 shake=10;
 for(let i=0;i<20;i++)
 particles.push({x:ball.x,y:ball.y,vx:(Math.random()-0.5)*6,vy:-Math.random()*6,life:30});
 beep(120);
}

function updatePlayer(p,isAI=false){
 if(!isAI){
  let sp=keys["Shift"]&&p.stam>0?14:p.speed;
  if(keys["a"]) p.vx=-sp;
  else if(keys["d"]) p.vx=sp;
  else p.vx*=0.8;
  if(keys["Shift"]&&p.stam>0) p.stam-=0.7; else p.stam+=0.4;
  p.stam=Math.max(0,Math.min(100,p.stam));
  if(keys["w"]&&p.y+p.h>=FLOOR){p.vy=-p.jump;beep(300);}
  if(keys[" "]&&ball.held&&ball.owner==="p") shoot(p);
 } else {
  if(ball.x>ai.x) ai.vx=4; else ai.vx=-4;
  if(Math.random()<0.01&&ai.y+ai.h>=FLOOR) ai.vy=-18;
  if(ball.held&&ball.owner==="ai"&&Math.random()<0.02) shoot(ai);
 }
 p.vy+=G;
 p.x+=p.vx; p.y+=p.vy;
 if(p.y+p.h>=FLOOR){p.y=FLOOR-p.h;p.vy=0;}
}

function update(){
 if(paused||over) return;

 updatePlayer(player);
 updatePlayer(ai,true);

 if(ball.held){
  let o=ball.owner==="p"?player:ai;
  ball.x=o.x+o.w/2; ball.y=o.y+30;
  if(o===player && Math.abs(o.x-hoop.x)<60 && o.y<260) dunk(o);
 } else {
  ball.vy+=G;
  ball.x+=ball.vx; ball.y+=ball.vy;
 }

 if(ball.y>520) resetBall(ball.owner);

 function scoreCheck(p,isPlayer){
  if(ball.x>hoop.x-10&&ball.x<hoop.x+hoop.w&&
     ball.y>220&&ball.y<235&&ball.vy>0){
   let pts=ball.x<700?2:3;
   p.score+=pts;
   shake=8;beep(800);
   resetBall(isPlayer?"ai":"p");
  }
 }
 scoreCheck(player,true);
 scoreCheck(ai,false);

 particles.forEach(pt=>{
  pt.x+=pt.vx; pt.y+=pt.vy; pt.vy+=0.3; pt.life--;
 });
 particles=particles.filter(p=>p.life>0);

 time-=1/60;
 if(time<=0){over=true;}
}

function draw(){
 ctx.save();
 if(shake) ctx.translate((Math.random()-0.5)*shake,(Math.random()-0.5)*shake);
 ctx.clearRect(0,0,1000,520);

 ctx.fillStyle="#333";ctx.fillRect(0,FLOOR,1000,90);

 ctx.fillStyle="#ffcc00";
 ctx.fillRect(player.x,player.y,player.w,player.h);
 ctx.fillStyle="#ff4444";
 ctx.fillRect(ai.x,ai.y,ai.w,ai.h);

 ctx.fillStyle="orange";
 ctx.beginPath();ctx.arc(ball.x,ball.y,10,0,6.28);ctx.fill();

 ctx.fillStyle="red";
 ctx.fillRect(hoop.x,220,50,10);
 ctx.fillStyle="white";
 ctx.fillRect(hoop.x+40,180,8,80);

 particles.forEach(p=>{
  ctx.fillStyle="yellow";
  ctx.fillRect(p.x,p.y,4,4);
 });

 ctx.fillStyle="white";
 ctx.font="20px Arial";
 ctx.fillText("YOU: "+player.score,20,30);
 ctx.fillText("AI: "+ai.score,20,55);
 ctx.fillText("TIME: "+Math.ceil(time),450,30);

 ctx.fillStyle="lime";
 ctx.fillRect(20,70,player.stam*2,8);

 if(over){
  ctx.fillStyle="rgba(0,0,0,0.7)";
  ctx.fillRect(0,0,1000,520);
  ctx.fillStyle="white";
  ctx.font="40px Arial";
  ctx.fillText(
   player.score>ai.score?"YOU WIN ðŸ†":"YOU LOSE ðŸ˜­",
   380,260
  );
 }
 ctx.restore();
 if(shake>0) shake--;
}

setInterval(()=>{ if(!paused) update(); },1000/60);
(function loop(){ draw(); requestAnimationFrame(loop); })();

onkeydown=e=>{
 if(e.key==="p") paused=!paused;
 if(e.key==="r") resetBall("p");
};
</script>
</body>
</html>
